# Web Vulnerability Scanner

This script is designed to scan web applications for various types of vulnerabilities, including those listed in the OWASP Top 10 Web Application Security Risks for 2021. The script uses multiple scanning functions to identify potential security issues and provides recommendations for remediation.

## Features

- **SQL Injection Scanning**: Detects SQL Injection vulnerabilities using common payloads and provides remediation suggestions.
- **Cross-Site Scripting (XSS) Scanning**: Identifies XSS vulnerabilities using common payloads and provides remediation suggestions.
- **Security Misconfigurations Scanning**: Checks for the presence of important security headers and provides remediation suggestions.
- **Broken Authentication Scanning**: Tests for default credentials and weak authentication mechanisms and provides remediation suggestions.
- **Session Management Scanning**: Examines session cookies for secure and HttpOnly attributes.
- **Vulnerable Components Scanning**: Detects the use of outdated or vulnerable third-party components.
- **Nmap Scanning**: Performs Nmap scans to detect open ports and services.
- **Information Gathering**: Collects information about the target web application, including web server fingerprinting and application enumeration.
- **Identification and Authentication Failures Scanning**: Checks for weak authentication mechanisms.
- **Software and Data Integrity Failures Scanning**: Identifies the use of known vulnerable libraries.
- **Security Logging and Monitoring Failures Scanning**: Checks for the presence of security logs.
- **Server-Side Request Forgery (SSRF) Scanning**: Detects SSRF vulnerabilities using common payloads.

## Advanced Models and Reinforcement Learning

The Pentest-agent now includes advanced models with reinforcement learning capabilities, allowing it to predict future vulnerabilities and improve its performance over time. The agent is designed to develop an advanced automated penetration testing agent for bug bounty purposes, including specialized agents for different sectors.

### Specialized Pentest-Agents
- **Android Pentesting Agent**: Analyzes APK files for vulnerabilities, performs static and dynamic analysis, and provides remediation suggestions.
- **Web Pentesting Agent**: Scans web applications for various types of vulnerabilities, including those listed in the OWASP Top 10 Web Application Security Risks.
- **iOS Pentesting Agent**: Analyzes iOS applications for vulnerabilities, verifies code signing, and detects buffer overflows.
- **Cloud Pentesting Agent**: Analyzes cloud infrastructure for misconfigurations and vulnerabilities, including S3 buckets, IAM policies, security groups, and EC2 instances.
- **LLM Pentesting Agent**: Uses large language models to analyze text for security vulnerabilities and generate detailed security reports.

### UI Integration
- **Dark and Bright Mode**: The UI supports both dark and bright modes, providing a seamless user experience.

### Security
- **Secured API Keys**: API keys are secured using environment variables to prevent exposure in the codebase.

### Reinforcement Learning
- **Predict Future Vulnerabilities**: The agent uses reinforcement learning with the PPO algorithm to predict future vulnerabilities and improve its performance over time.

### Dataset Updates
- **Automated Dataset Updates**: The agent can create and update its own datasets through internet connectivity, ensuring it stays up-to-date with the latest vulnerabilities.

### New Endpoints
- **Specialized Endpoints**: New endpoints for specialized Pentest-agents have been added to the backend, allowing users to perform targeted penetration testing for different sectors.

## Prerequisites

- Python 3.10.12 or higher
- Docker installed on the system

## Usage

To run the web vulnerability scanner, use the following command:

```bash
python3 web_vulnerability_scanner.py <URL> --user-agent <User-Agent> [--output <Output File>] [--login-url <Login URL>]
```

### Arguments

- `<URL>`: The URL of the web application to scan.
- `--user-agent`: The User-Agent string to use in requests (default: "HackerOne + your H1 username").
- `--output`: The file to save the scan results in JSON format (optional).
- `--login-url`: The login URL to use for Broken Authentication scanning (optional).

### Example

```bash
python3 web_vulnerability_scanner.py http://localhost:9090/WebGoat --user-agent "Devin/1.0" --output scan_results.json
```

## Scan Results

The scan results are saved in JSON format and include detailed information about each identified vulnerability, including the type, URL, payload (if applicable), status, severity, recommendations for remediation, and specific remediation steps with examples.

## Automated Remediation Suggestions

The web vulnerability scanner now includes automated remediation suggestions for identified vulnerabilities. These suggestions provide specific steps and example code to help you address the vulnerabilities found during the scan. This feature enhances the scanner's utility by not only identifying security issues but also guiding you on how to fix them effectively.

## Installation

To install the required dependencies, use the following command:

```bash
pip install -r requirements.txt
```

## Setting Up the Local Testing Environment

To set up the local testing environment, you can use Docker to start the OWASP WebGoat and DVWA containers. Use the following commands to start the containers:

```bash
# Start OWASP WebGoat
docker run -d -p 9090:8080 webgoat/webgoat-8.0

# Start DVWA
docker run -d -p 8081:80 vulnerables/web-dvwa
```

## Best Practices

- Always conduct penetration tests responsibly and ethically.
- Follow the rules and guidelines of the bug bounty program you are participating in, such as those of REI.
- Do not perform tests that could disrupt the service for other users.
- Use your own accounts and do not access other people's data or accounts.

## Troubleshooting

### Common Issues

- **Installation Errors**: Ensure that you have the correct version of Python and Docker installed. Verify that all dependencies are installed correctly using `pip install -r requirements.txt`.
- **Network Issues**: If the scanner is unable to reach the target URL, check your network connection and ensure that the target URL is accessible.
- **Permission Errors**: Run the script with appropriate permissions if you encounter permission-related issues.

### UI Models

- Dark Mode

![image](https://github.com/VishwamAI/Pentest-agent/assets/81065703/6e74890a-b6ba-401d-b8f4-b42ece6f5fbf)

- Bright Mode

![image](https://github.com/VishwamAI/Pentest-agent/assets/81065703/27c7be40-619d-4d38-ada7-73ed8293ea40)

## Contributing

Contributions are welcome! Please submit a pull request or open an issue to discuss any changes or improvements.

For major changes, please open an issue first to discuss what you would like to change.

## License

This project is licensed under the MIT License.

## Contact

For support or to contribute to the project, please open an issue on the GitHub repository or contact the project maintainers.
